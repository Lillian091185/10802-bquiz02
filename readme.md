# 題組二解題步驟

## 步驟一：將素材目錄複製到崗位目錄下，確認素材內容與抽題題號一致
監評長按下倒數計時後，可以先把桌面上素材目錄中的題目素材複製一份到自己的工作目錄下，這時要確認自己複製的題目和抽到的題目是一致的，之後都在工作目錄下來取用相關的素材，這樣比較不容易出錯；在安裝軟體的準備時間裏，也要確認一下電腦桌面中是否有包含了素材這個目錄，並且四個題組的素材都在其中。

---

## 步驟二：將版型檔案及相關素材複製到網站根目錄下，並進行相應的更名及整理
  1. 開立./css, ./js, ./icon等常用目錄以利檔案分類及管理
  2. 將素材檔中的.css, .js, 及icon圖檔複製到相應的目錄下
  3. 更改版型素材的相關檔名，以符合解題的需要，雖然素材僅提供一個html檔，但根據題意，我們需要有一個後台的功能在，只不過標題區和登入及頁尾區的內容都是一樣的，因此我們會把這些地方的功能完成後，再直接複製成兩個檔案一個做為前台的版型，一個做為後台的版型。
      * 02P01.htm => index.php
      * 02P01.htm => admin.php (先不做，之後做完共同的功能後再複製改名)
  4. 更改版型素材的相關連結及匯入檔內容
      * 修改 `index.php` 中 `<link>` 及 `<script>` 中的連結路徑，指向正確的位置
      * 修改 `./css/css.css` 中的圖片 `url` ，指向根目錄下的 `../icon` 目錄
      * 刪除 `index.php` 中的 `<iframe>...</iframe>` ，我們會使用 `ajax` 來取代 `<iframe>`
  5. 開啟 `xampp` 及 `apache` 伺服器，使用 `localhost` 或 `127.0.0.1` 檢視網頁是否正確顯示，css 的載入是否正確

---

## 步驟三：進行前後台的檔案整理及切版，分離出共用的區塊或功能。
  1. 建立 `front`及 `admin` 兩個目錄，一個代表前台的相關檔案，一個代表後台的相關檔案，前後台共用的元件則先放在根目錄下，或另開一個 `comm` 目錄用來存放共用的元件。
  2. 分離出頁首標題及頁尾頁腳的區塊成為 `header.php` 及 `footer.php`，不過因為此題的頁首頁尾是寫死的，所以不切出來也沒有關係。
  3. 在 `index.php` 中找到右側主要內容區的區塊。
  4. 使用 `include` 指令來重新組合 `index.php` 頁面，並加上判斷式來確保要組合的檔案是存在的。
  5. 以 `get` 的方式來傳遞各頁面要組合的元件內容，比如 `do=login` 表示要看到的是登入頁面，因此在前台的 `include` 中可以併入 `login.php` 來呈現。
  6. 在 `./front` 及 `./admin` 目錄中，先建立一個 `home.php` 來當成預設內容，隨便打幾個字讓頁面不會出現找不到檔案的錯誤就可以了。

---

## 步驟四：建立資料庫連線檔及常用函式。
  1. 建立 `base.php` 檔，用來放共用的設定及函式。
  2. 設定好PDO的連線參數 `$pdo=new PDO()`
  3. 啟用session `session_start()`
  4. 建立全域變數或是共用函式
      * find(\$table,...\$arg) - 尋找特定條件的單筆資料或第一筆資料
      * all(\$table,...\$arg) - 取得資料表的全部資料或是特定條件的全部資料
      * nums(\$table,...\$arg) - 計算符合條件的資料筆數
      * save(\$talbe,\$data) - 新增或更新單筆資料
      * del(\$table,...\$arg) - 刪除特定條件的全部資料
      * q(\$sql) - 簡化 \$pdo->query(\$sql)->fetchAll() 的使用;
      * to(\$path) - 簡化 header("location:xxxxxx") 的使用;
  5. 做好以上工作後，可以先建一張簡單的資料表，把資料庫連線及所有自訂函式功能先測試一次，以確保後續使用不會有問題。

---

## 步驟五：建立資料表及預設資料。
每個題組依狀況不同，在這一步有不同的做法，視自己對題目的熟悉程度來做應變，可以一次把全部資料表建完，也可以視解題的進度來逐步建立或修改資料表。
根據題意，題組二會需要用到以下的資料表：
* user - 會員資料表(含管理者帳號)
* total - 訪客統計資料表
* news - 文章資料表
* que - 問卷資料表
* log - 按讚紀錄表

1. 依序建立功能需要的五張資料表:
  * user

    | name |  type  |  pk | default | A_I |   note   |
    |:----:|:------:|:---:|:-------:|:---:|:--------:|
    |id    |int(10) | yes |         | yes | 流 水 號 |
    |acc   |text    |     |         |     | 帳　　號 |
    |pw    |text    |     |         |     | 密　　碼 |
    |email |text    |     |         |     | 電子郵件 |
    
  * total

    | name |  type  |  pk | default | A_I |   note  |
    |:----:|:------:|:---:|:-------:|:---:|:-------:|
    |id    |int(10) | yes |         | yes | 流 水 號 |
    |date  |date    |     |         |     | 日　　期 |
    |total |int(10) |     |         |     | 訪客人數 |

  * news
  
    | name |  type  |  pk | default | A_I |  note  |
    |:----:|:------:|:---:|:-------:|:---:|:------:|
    |id    |int(10) | yes |         | yes | 流水號 |
    |title |text    |     |         |     | 標　題 |
    |text  |text    |     |         |     | 內　容 |
    |type  |int(5)  |     |         |     | 分　類 |
    |good  |int(5)  |     |   0     |     | 按讚數 |  
    |sh    |int(1)  |     |   1     |     | 顯　示 |

  * que

    | name |  type  |  pk | default | A_I |   note   |
    |:----:|:------:|:---:|:-------:|:---:|:--------:|
    |id    |int(10) | yes |         | yes | 流 水 號 |
    |text  |text    |     |         |     | 文字內容 |
    |parent|int(5)  |     |         |     | 題目 id  |
    |count |int(5)  |     |   0     |     | 統　　計 |

  * log

    | name |  type       |  pk | default | A_I |   note  |
    |:----:|:-----------:|:---:|:-------:|:---:|:--------:|
    |id    |int(10)      | yes |         | yes | 流水號   |
    |news  |int(5)       |     |         |     | 文章id   |
    |user  |varchar(128) |     |         |     | 會員帳號 |

2. 為了解題順利，可以把資料表中的一些欄位設為可接受空值的狀況，這樣即使未設定內容，也能正常新增或更改資料，不過這個做法只是為了先求解題完成而做的取巧，實務上應該根據需求及功能來決定欄位是否可以接受空值，並在程式端檢查來源資料是否為空值

---

## 步驟六：建置網站標題區。
這邊我們先來處理網站標題區，這邊比較麻煩的是瀏灠人次不是採總計，而是分日計算然後再總計；雖然題目沒有指示是否要和第一題一樣的機制，但我們在設計上為了避免瀏灠人次一直跳動，所以還是採用session來紀錄使用者的進站狀況，關閉瀏灠器再開才會重新計算；

1. 在 `index.php` 中的最前頭 include `base.php` 檔，我們會利用 `base.php ` 中的各項函式來處理資料
2. 在 `header.php` 中設定標題圖片
3. 在 `header.php` 中判斷瀏灠人次session變數的存在並進行瀏灠人次資料的取得或新增
4. 計算當日瀏灠人次及計算總人次然後顯示在頁面上
5. 在 `header.php` 中加入 **回首頁** 的連結，採用 `float:right`的方式定位在最右側

在檢查時，記得更改一下windows的日期來做檢查，評分時也會被要求更改日期，來確認瀏灠人次是會依日期重新計算，同時可以總計不同日期的總人次

---

## 步驟七：建置主選單區及動態文字廣告。
這邊其實幾乎算送分了，因為主選單的內容己經在版型檔案中先做好了，連背景圖都設定好了，所以這邊唯一需要做的是把動態文字廣告的字打上去即可，這邊要注意的是動態文字廣告區的右側要留點空間給登入資訊使用。
* 在 `index.php` 中加入動態文字廣告區的文字，我們使用 `<marquee></marquee>` 標籤來完成即可
* 將 `<marquee>` 標籤設定為寬度80%的inline-block區塊和會員登入的文字區塊放在一起

---

## 步驟八：建置會員登入/登出/註冊及忘記密碼功能。
這邊我們會一鼓作氣的把會員註冊/登入/登出及忘記密碼都做完，一共11個項目可以拿到55分，依據題意，這邊要使用ajax來製作會比較適當，也比較好呈現題目要求的各項提示訊息：
1. 在 `./front/` 目錄下建立 `login.php`、`find_pw.php`、`reg.php`三個檔案，並建立需要的頁面HTML碼
2. 使用 `<fieldset><legend></legend></fieldset>` 來產生群組外框標題字的效果
3. 建立 `./api/` 目錄並建立 `chkacc.php`、`chkpw.php`、`find_pw.php`,`reg.php`四個api檔
4. 根據題意撰寫需要的前端js程式碼及後端的php程式碼

```
由於版型素材提供的css並不是全部都可用，因此如果要畫面美觀的話，很多的css要自己寫，
美化的工作建議可以等功能都做完時再回頭來改就可以了。
```
